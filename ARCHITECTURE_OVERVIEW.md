# Wassel - Architecture Overview

Visual representation of the complete Wassel platform architecture.

---

## ğŸ—ï¸ SYSTEM ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER DEVICES                             â”‚
â”‚  ğŸ“± Mobile     ğŸ’» Tablet     ğŸ–¥ï¸ Desktop                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FRONTEND (React + TypeScript)               â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Landing   â”‚  â”‚    Auth    â”‚  â”‚ Dashboard  â”‚           â”‚
â”‚  â”‚   Page     â”‚  â”‚    Page    â”‚  â”‚  & Pages   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         NAVIGATION (Sidebar + Header)              â”‚    â”‚
â”‚  â”‚  â€¢ Dashboard     â€¢ Favorites    â€¢ Referrals        â”‚    â”‚
â”‚  â”‚  â€¢ Find Ride     â€¢ Messages     â€¢ Promo Codes      â”‚    â”‚
â”‚  â”‚  â€¢ Offer Ride    â€¢ Analytics    â€¢ Business         â”‚    â”‚
â”‚  â”‚  â€¢ My Trips      â€¢ Notifications â€¢ Settings        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  Custom Hooks   â”‚  â”‚   UI Components  â”‚                â”‚
â”‚  â”‚                 â”‚  â”‚                  â”‚                â”‚
â”‚  â”‚ â€¢ useRealTrips  â”‚  â”‚ â€¢ Shadcn/ui      â”‚                â”‚
â”‚  â”‚ â€¢ useBookings   â”‚  â”‚ â€¢ Cards          â”‚                â”‚
â”‚  â”‚ â€¢ useMessages   â”‚  â”‚ â€¢ Dialogs        â”‚                â”‚
â”‚  â”‚ â€¢ useNotify     â”‚  â”‚ â€¢ Tables         â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         STATE MANAGEMENT                           â”‚    â”‚
â”‚  â”‚  â€¢ AuthContext (User & Session)                    â”‚    â”‚
â”‚  â”‚  â€¢ Local State (useState, useEffect)               â”‚    â”‚
â”‚  â”‚  â€¢ Real-time Polling (Notifications)               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTPS/REST API
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BACKEND (Supabase Edge Functions)               â”‚
â”‚                    Deno + Hono Framework                     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              API ENDPOINTS (22)                    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Authentication     Trips          Messages       â”‚    â”‚
â”‚  â”‚  â€¢ POST /signup     â€¢ POST /trips  â€¢ POST /msg    â”‚    â”‚
â”‚  â”‚                     â€¢ GET /search  â€¢ GET /conv    â”‚    â”‚
â”‚  â”‚  Profiles           â€¢ GET /:id                    â”‚    â”‚
â”‚  â”‚  â€¢ GET /:userId     â€¢ PUT /:id     Notifications  â”‚    â”‚
â”‚  â”‚  â€¢ PUT /:userId                    â€¢ GET /notify  â”‚    â”‚
â”‚  â”‚                     Bookings       â€¢ PUT /read    â”‚    â”‚
â”‚  â”‚  Wallet            â€¢ POST /book                   â”‚    â”‚
â”‚  â”‚  â€¢ GET /wallet     â€¢ PUT /:id      Reviews        â”‚    â”‚
â”‚  â”‚  â€¢ POST /add       â€¢ GET /user     â€¢ POST /review â”‚    â”‚
â”‚  â”‚                                    â€¢ GET /:userId â”‚    â”‚
â”‚  â”‚  Referrals         Recurring                      â”‚    â”‚
â”‚  â”‚  â€¢ GET /code       â€¢ POST /create  Analytics      â”‚    â”‚
â”‚  â”‚  â€¢ POST /apply     â€¢ GET /list     â€¢ GET /stats   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Emergency         Health Check                   â”‚    â”‚
â”‚  â”‚  â€¢ GET /contacts   â€¢ GET /health                  â”‚    â”‚
â”‚  â”‚  â€¢ POST /add                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           BUSINESS LOGIC & SERVICES                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â€¢ Authentication Middleware                       â”‚    â”‚
â”‚  â”‚  â€¢ Automatic Notifications                         â”‚    â”‚
â”‚  â”‚  â€¢ Rating Calculations                             â”‚    â”‚
â”‚  â”‚  â€¢ Seat Management                                 â”‚    â”‚
â”‚  â”‚  â€¢ Wallet Transactions                             â”‚    â”‚
â”‚  â”‚  â€¢ Referral Bonuses                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DATABASE (Supabase)                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         KV STORE (Key-Value Storage)               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Data Types:                                       â”‚    â”‚
â”‚  â”‚  â€¢ profile:{userId}       â†’ User Profiles          â”‚    â”‚
â”‚  â”‚  â€¢ trip:{timestamp}:{id}  â†’ Trip Records           â”‚    â”‚
â”‚  â”‚  â€¢ booking:{ts}:{id}      â†’ Booking Records        â”‚    â”‚
â”‚  â”‚  â€¢ message:{ts}:{id}      â†’ Messages               â”‚    â”‚
â”‚  â”‚  â€¢ notification:{ts}:{id} â†’ Notifications          â”‚    â”‚
â”‚  â”‚  â€¢ review:{ts}:{id}       â†’ Reviews                â”‚    â”‚
â”‚  â”‚  â€¢ recurring:{ts}:{id}    â†’ Recurring Trips        â”‚    â”‚
â”‚  â”‚  â€¢ emergency:{uid}:{ts}   â†’ Emergency Contacts     â”‚    â”‚
â”‚  â”‚  â€¢ transaction:{ts}:{id}  â†’ Transactions           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         AUTHENTICATION (Supabase Auth)             â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â€¢ Email/Password Authentication                   â”‚    â”‚
â”‚  â”‚  â€¢ JWT Token Management                            â”‚    â”‚
â”‚  â”‚  â€¢ Session Handling                                â”‚    â”‚
â”‚  â”‚  â€¢ Automatic Email Confirmation                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š DATA FLOW DIAGRAMS

### 1. User Sign Up Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚        â”‚ Frontend â”‚        â”‚ Backend â”‚        â”‚ Database â”‚
â”‚ Browser â”‚        â”‚   Auth   â”‚        â”‚  Server â”‚        â”‚ KV Store â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚ Fill Form        â”‚                   â”‚                  â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ POST /signup      â”‚                  â”‚
     â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚ Create Auth User â”‚
     â”‚                  â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚ Create Profile   â”‚
     â”‚                  â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ Success + Token   â”‚                  â”‚
     â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚ Redirect to App  â”‚                   â”‚                  â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
```

### 2. Trip Booking Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Passengerâ”‚   â”‚ Frontend â”‚   â”‚ Backend â”‚   â”‚ Database â”‚   â”‚ Driver  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚ Search Tripsâ”‚              â”‚             â”‚             â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚ GET /search  â”‚             â”‚             â”‚
     â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚ Query Trips â”‚             â”‚
     â”‚             â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚ Trip List    â”‚             â”‚             â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚ Book Trip   â”‚              â”‚             â”‚             â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚ POST /bookingâ”‚             â”‚             â”‚
     â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚ Save Bookingâ”‚             â”‚
     â”‚             â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚ Create Notification       â”‚
     â”‚             â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚ Success      â”‚             â”‚             â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚             â”‚
     â”‚             â”‚              â”‚             â”‚   Notification
     â”‚             â”‚              â”‚             â”‚   Appears
     â”‚             â”‚              â”‚             â”‚      â”‚
     â”‚             â”‚              â”‚             â”‚      â–¼
     â”‚             â”‚              â”‚             â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚             â”‚              â”‚             â”‚ â”‚ Accept/ â”‚
     â”‚             â”‚              â”‚             â”‚ â”‚ Reject  â”‚
     â”‚             â”‚              â”‚             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Real-time Notification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚        â”‚ Frontend â”‚        â”‚ Backend â”‚        â”‚ Database â”‚
â”‚ Browser â”‚        â”‚  Hook    â”‚        â”‚  Server â”‚        â”‚ KV Store â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ Initial Load      â”‚                  â”‚
     â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚ GET Notificationsâ”‚
     â”‚                  â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ Notifications     â”‚                  â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ â° Wait 30s       â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ Poll Again        â”‚                  â”‚
     â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚ GET Notificationsâ”‚
     â”‚                  â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ New Notifications â”‚                  â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚ ğŸ”” Toast Shows   â”‚                   â”‚                  â”‚
     â”‚                  â”‚                   â”‚                  â”‚
     â”‚                  â”‚ â° Repeat...      â”‚                  â”‚
```

---

## ğŸ¯ COMPONENT HIERARCHY

```
App.tsx (Root)
â”‚
â”œâ”€ AuthProvider (Context)
â”‚
â””â”€ AppContent
   â”‚
   â”œâ”€ LandingPage (if not authenticated)
   â”‚
   â”œâ”€ AuthPage (login/signup flow)
   â”‚
   â””â”€ Main Application (if authenticated)
      â”‚
      â”œâ”€ Sidebar
      â”‚  â”œâ”€ Logo
      â”‚  â”œâ”€ Main Menu Items (7)
      â”‚  â””â”€ Account Menu Items (10)
      â”‚
      â”œâ”€ Header
      â”‚  â”œâ”€ Menu Button
      â”‚  â”œâ”€ Notification Bell
      â”‚  â””â”€ User Avatar
      â”‚
      â””â”€ Page Content (Dynamic)
         â”‚
         â”œâ”€ Dashboard
         â”œâ”€ FindRide
         â”‚  â”œâ”€ Search Form
         â”‚  â”œâ”€ AdvancedFilters
         â”‚  â””â”€ TripDetailsDialog
         â”‚
         â”œâ”€ OfferRide
         â”‚  â””â”€ MapComponent
         â”‚
         â”œâ”€ MyTrips
         â”‚  â””â”€ LiveTripMap
         â”‚
         â”œâ”€ Messages
         â”œâ”€ Payments
         â”‚  â””â”€ SplitPayment (Dialog)
         â”‚
         â”œâ”€ UserProfile
         â”‚  â””â”€ RatingDialog
         â”‚
         â”œâ”€ NotificationCenter
         â”œâ”€ SafetyCenter
         â”œâ”€ TripAnalytics
         â”œâ”€ RecurringTrips
         â”œâ”€ VerificationCenter
         â”‚
         â”œâ”€ Favorites (NEW)
         â”œâ”€ ReferralProgram (NEW)
         â”œâ”€ PromoCodesManager (NEW)
         â”œâ”€ BusinessAccounts (NEW)
         â”‚
         â””â”€ Settings
```

---

## ğŸ”„ STATE MANAGEMENT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           GLOBAL STATE (Context)               â”‚
â”‚                                                â”‚
â”‚  AuthContext                                   â”‚
â”‚  â”œâ”€ user: User | null                         â”‚
â”‚  â”œâ”€ session: Session | null                   â”‚
â”‚  â”œâ”€ loading: boolean                          â”‚
â”‚  â”œâ”€ isBackendConnected: boolean               â”‚
â”‚  â”œâ”€ signup(credentials)                       â”‚
â”‚  â”œâ”€ login(credentials)                        â”‚
â”‚  â””â”€ logout()                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         COMPONENT STATE (useState)             â”‚
â”‚                                                â”‚
â”‚  Per Component:                                â”‚
â”‚  â”œâ”€ Local UI state                            â”‚
â”‚  â”œâ”€ Form inputs                               â”‚
â”‚  â”œâ”€ Loading states                            â”‚
â”‚  â”œâ”€ Error messages                            â”‚
â”‚  â””â”€ Temporary data                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       REMOTE STATE (Custom Hooks)              â”‚
â”‚                                                â”‚
â”‚  useRealTrips                                  â”‚
â”‚  â”œâ”€ trips: Trip[]                             â”‚
â”‚  â”œâ”€ loading: boolean                          â”‚
â”‚  â”œâ”€ error: string | null                      â”‚
â”‚  â””â”€ CRUD operations                           â”‚
â”‚                                                â”‚
â”‚  useRealBookings                               â”‚
â”‚  â”œâ”€ bookings: Booking[]                       â”‚
â”‚  â””â”€ CRUD operations                           â”‚
â”‚                                                â”‚
â”‚  useRealNotifications                          â”‚
â”‚  â”œâ”€ notifications: Notification[]             â”‚
â”‚  â”œâ”€ unreadCount: number                       â”‚
â”‚  â””â”€ Auto-polling (30s)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ºï¸ FEATURE DEPENDENCY MAP

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Auth     â”‚
                    â”‚ (Required)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                     â”‚
        â–¼                                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Profile â”‚                         â”‚  Trips   â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚                                   â”‚
        â”œâ”€â”€> Verification                   â”œâ”€â”€> Bookings
        â”‚                                   â”‚
        â”œâ”€â”€> Emergency Contacts             â”œâ”€â”€> Reviews
        â”‚                                   â”‚
        â”œâ”€â”€> Wallet                         â”œâ”€â”€> Messages
        â”‚                                   â”‚
        â”œâ”€â”€> Referrals                      â”œâ”€â”€> Notifications
        â”‚                                   â”‚
        â””â”€â”€> Analytics                      â””â”€â”€> Live Tracking


        Independent Features:
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Favorites  â”‚  â”‚ Promo Codes â”‚  â”‚ Business â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ DATA MODELS

### User Profile
```typescript
{
  id: string,              // User ID
  email: string,
  full_name: string,
  phone?: string,
  email_verified: boolean,
  phone_verified: boolean,
  total_trips: number,
  trips_as_driver: number,
  trips_as_passenger: number,
  rating_as_driver: number,
  rating_as_passenger: number,
  total_ratings_received: number,
  smoking_allowed: boolean,
  pets_allowed: boolean,
  music_allowed: boolean,
  language: 'en' | 'ar',
  currency: 'AED',
  wallet_balance: number,
  total_earned: number,
  total_spent: number,
  referral_code?: string,
  referral_count?: number,
  referral_earnings?: number,
  referred_by?: string,
  created_at: string,
  updated_at: string
}
```

### Trip
```typescript
{
  id: string,
  driver_id: string,
  from: string,
  to: string,
  departure_date: string,
  departure_time: string,
  price_per_seat: number,
  total_seats: number,
  available_seats: number,
  trip_type: 'wasel' | 'raje3',
  status: 'published' | 'in_progress' | 'completed' | 'cancelled',
  stops?: Array<{lat, lng, label}>,
  preferences?: {smoking_allowed, pets_allowed, music_allowed},
  vehicle?: {make, model, year, color, plate_number},
  bookings: string[],        // Array of booking IDs
  created_at: string,
  updated_at: string
}
```

### Booking
```typescript
{
  id: string,
  trip_id: string,
  passenger_id: string,
  seats_requested: number,
  pickup_stop: string,
  dropoff_stop: string,
  status: 'pending' | 'accepted' | 'rejected' | 'cancelled' | 'completed',
  total_price: number,
  created_at: string,
  updated_at: string
}
```

---

## ğŸ” SECURITY LAYERS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CLIENT-SIDE SECURITY                   â”‚
â”‚                                                â”‚
â”‚  â€¢ Input Validation                           â”‚
â”‚  â€¢ HTTPS Only                                 â”‚
â”‚  â€¢ No sensitive data in localStorage          â”‚
â”‚  â€¢ JWT tokens in memory                       â”‚
â”‚  â€¢ Auto-logout on token expiry                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         BACKEND SECURITY                       â”‚
â”‚                                                â”‚
â”‚  â€¢ JWT Token Verification                     â”‚
â”‚  â€¢ User Authorization Checks                  â”‚
â”‚  â€¢ Input Sanitization                         â”‚
â”‚  â€¢ Rate Limiting (Supabase)                   â”‚
â”‚  â€¢ CORS Configuration                         â”‚
â”‚  â€¢ SQL Injection Prevention (KV Store)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DATABASE SECURITY                      â”‚
â”‚                                                â”‚
â”‚  â€¢ Encrypted at Rest (Supabase)               â”‚
â”‚  â€¢ Encrypted in Transit (TLS 1.3)             â”‚
â”‚  â€¢ Access Control (Service Role Key)          â”‚
â”‚  â€¢ Automatic Backups                          â”‚
â”‚  â€¢ Audit Logs                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ SCALABILITY ARCHITECTURE

```
        LOW TRAFFIC (0-1K users)
        â”œâ”€ Supabase Free Tier
        â”œâ”€ Single Region
        â””â”€ Basic Monitoring

                â”‚
                â–¼

        MEDIUM TRAFFIC (1K-50K users)
        â”œâ”€ Supabase Free/Pro Tier
        â”œâ”€ CDN for Static Assets
        â”œâ”€ Edge Functions
        â””â”€ Enhanced Monitoring

                â”‚
                â–¼

        HIGH TRAFFIC (50K-500K users)
        â”œâ”€ Supabase Pro Tier
        â”œâ”€ Multi-Region Deployment
        â”œâ”€ Database Read Replicas
        â”œâ”€ Caching Layer (Redis)
        â””â”€ Advanced Analytics

                â”‚
                â–¼

        ENTERPRISE (500K+ users)
        â”œâ”€ Supabase Enterprise
        â”œâ”€ Dedicated Database
        â”œâ”€ Global CDN
        â”œâ”€ Load Balancing
        â”œâ”€ Microservices Architecture
        â””â”€ 24/7 Support
```

---

## ğŸ¨ TECH STACK OVERVIEW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FRONTEND                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Framework:      React 18 + TypeScript              â”‚
â”‚  Styling:        Tailwind CSS v4.0                  â”‚
â”‚  UI Library:     Shadcn/ui                          â”‚
â”‚  Icons:          Lucide React                       â”‚
â”‚  Maps:           React Leaflet + OpenStreetMap      â”‚
â”‚  Charts:         Recharts                           â”‚
â”‚  Animations:     Motion (Framer Motion)             â”‚
â”‚  Toast:          Sonner                             â”‚
â”‚  Forms:          React Hook Form                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BACKEND                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Runtime:        Deno                               â”‚
â”‚  Framework:      Hono                               â”‚
â”‚  Platform:       Supabase Edge Functions            â”‚
â”‚  Database:       Supabase KV Store                  â”‚
â”‚  Auth:           Supabase Auth (JWT)                â”‚
â”‚  Storage:        Supabase Storage (ready)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 DEVELOPMENT                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Language:       TypeScript                         â”‚
â”‚  Build:          Vite                               â”‚
â”‚  Linting:        ESLint                             â”‚
â”‚  Formatting:     Prettier                           â”‚
â”‚  Version:        Git                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Last Updated:** November 3, 2025  
**Architecture Version:** 1.0 - Production Ready
